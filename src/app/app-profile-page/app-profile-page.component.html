<div *ngIf="isLoading" style="text-align:center;">
  <fa name="cog" size="5x" animation="spin"></fa>
  <h1>Profiel aan het ophalen...</h1>
</div>

<div *ngIf="profile && !isLoading">
  <!-- START Profile bar left-->
  <div class="content" *ngIf="profile && !isLoading">
    <div class="c-row" style="height:92vh;">
      <div class="left">
        <h2 style="text-align: center;" [hidden]="isInEdit">{{profile.User.Name}}</h2>

        <div class="form-label-group input-group" style="padding-right: 10px; padding-top: 10px;" title="Naam" [hidden]="!isInEdit">
          <div class="input-group-prepend">
            <div class="input-group-text" id="btnGroupAddon">
              <fa name="tag"></fa>
            </div>
          </div>
          <input type="text" id="inputName" class="form-control rounded-input-with-label" [(ngModel)]="newName"
            [disabled]="!isInEdit || isSavingChanges">
        </div>

        <div class="form-label-group input-group" style="padding-right: 10px;" title="Gebruikersnaam">
          <div class="input-group-prepend">
            <div class="input-group-text" id="btnGroupAddon">
              <fa name="user"></fa>
            </div>
          </div>
          <input type="text" id="inputUsername" class="form-control rounded-input-with-label" [(ngModel)]="newUsername"
            [disabled]="!isInEdit || isSavingChanges">
        </div>

        <div class="form-label-group input-group" style="padding-right: 10px;" title="Wachtwoord" [hidden]="!isInEdit">
          <div class="input-group-prepend">
            <div class="input-group-text" id="btnGroupAddon">
              <fa name="lock"></fa>
            </div>
          </div>
          <input type="text" id="isInEdit" class="form-control rounded-input-with-label" [(ngModel)]="newPassword"
            [disabled]="!isInEdit || isSavingChanges" placeholder="Wachtwoord (ongewijzigd)">
        </div>


        <div class="form-label-group input-group" style="padding-right: 10px;" title="Geboortedatum">
          <div class="input-group-prepend">
            <div class="input-group-text" id="btnGroupAddon">
              <fa name="calendar"></fa>
            </div>
          </div>
          <input type="date" id="inputDate" class="form-control rounded-input-with-label" placeholder="Geboortedatum"
            [disabled]="!isInEdit || isSavingChanges" [ngModel]="newDate | date:'yyyy-MM-dd'">
        </div>

        <div class="form-label-group input-group" style="padding-right: 10px;" title="Email">
          <div class="input-group-prepend">
            <div class="input-group-text" id="btnGroupAddon">
              <fa name="envelope"></fa>
            </div>
          </div>
          <input type="email" id="inputEmail" class="form-control rounded-input-with-label" placeholder="Email adres"
            [(ngModel)]="newEmail" [disabled]="!isInEdit || isSavingChanges">
        </div>

        <div class="form-label-group input-group" style="padding-right: 10px;" title="Lengte (in cm)">
          <div class="input-group-prepend">
            <div class="input-group-text" id="btnGroupAddon">
              <fa name="user-md"></fa>
            </div>
          </div>
          <input type="number" id="inputLength" class="form-control rounded-input-with-label" placeholder="Lengte"
            [disabled]="!isInEdit || isSavingChanges" [(ngModel)]="newLength">
        </div>

        <div class="form-label-group input-group" style="padding-right: 10px;" title="Gewicht (in kg)">
          <div class="input-group-prepend">
            <div class="input-group-text" id="btnGroupAddon">
              <fa name="balance-scale"></fa>
            </div>
          </div>
          <input type="number" id="inputWeigth" class="form-control rounded-input-with-label" placeholder="Gewicht (in kg)"
            [disabled]="!isInEdit || isSavingChanges" [(ngModel)]="newWeigth">
        </div>

        <div class="form-label-group input-group" style="padding-right: 10px;" title="Lui?" [hidden]="isInEdit">
          <div class="input-group-prepend">
            <div class="input-group-text" id="btnGroupAddon">
              <fa name="bed"></fa>
            </div>
          </div>
          <input type="text" id="inputIsLazy" class="form-control rounded-input-with-label" placeholder="Is lui?"
            disabled [(ngModel)]="profile.IsLazy">
        </div>

        <div class="form-label-group input-group" *ngIf="isInEdit" style="padding-right: 10px;" title="Beveiligingsvraag">
          <div class="input-group-prepend">
            <div class="input-group-text" id="btnGroupAddon">
              <fa name="question"></fa>
            </div>
          </div>
          <select id="selectQuestion" class="form-control rounded-input-with-label" placeholder="Beveiligingsvraag"
            [(ngModel)]="newRecoveryQuestion" [disabled]="isLoadingQuestions || isSavingChanges">
            <option [ngValue]="null" disabled hidden>Kies een beveiligingsvraag...</option>
            <option *ngFor="let question of questions" [ngValue]="question.Id">
              {{question.RecoveryQuestion}}
            </option>
          </select>
        </div>

        <div class="form-label-group input-group" *ngIf="isInEdit" style="padding-right: 10px;" title="Beveiligingsantwoord">
          <div class="input-group-prepend">
            <div class="input-group-text" id="btnGroupAddon">
              <fa name="check"></fa>
            </div>
          </div>
          <input type="input" id="inputQuestion" class="form-control rounded-input-with-label" placeholder="Beveiligingsantwoord"
            [(ngModel)]="newRecoveryAnswer" required [disabled]="isLoadingQuestions || isSavingChanges">
        </div>

        <button class="btn btn-block" *ngIf="canEdit && !isInEdit" (click)="onEnableEdit()">
          <fa name="pencil"></fa>
          Wijzig profiel
        </button>
        <button class="btn btn-block btn-success" *ngIf="canEdit && isInEdit" (click)="onSaveEdit()" [disabled]="isSavingChanges">
          <div *ngIf="!isSavingChanges">
            <fa name="save"></fa> Opslaan
          </div>
          <div *ngIf="isSavingChanges">
            <fa name="cog" animation="spin" size="lg"></fa>
            Opslaan...
          </div>
        </button>
      </div>
    </div>
    <!-- STOP Profile bar left-->

    <div class="main-content">
      <h2 style="display: inline-block">Behaalde achievement!</h2>
      <ul>
        <li *ngFor="let a of completedAchievements">
          {{a.Achievement.Name}}
        </li>
      </ul>

      <h2>Zo dichtbij!</h2>
      <div *ngFor="let a of incompletedAchievements">
        {{a.Achievement.Name}}
        <div class="progress" style="width: 40%">
          <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" [ngStyle]="{'width': getPercentage(a)+'%'}"
            attr.aria-valuenow="{{getPercentage(a)}}" aria-valuemin="0" aria-valuemax="100">
            <span> <b>{{getPercentage(a)}}% ({{a.CurrentPoints}} / {{a.Achievement.RequiredPoints}})</b></span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="!profile && !isLoading" style="text-align:center;">
  <fa name="times" size="5x"></fa>
  <h1>Er is iets mis gegaan met het ophalen van het profiel!</h1>
</div>
